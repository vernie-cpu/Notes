## 一、OSI五层模型及七层参考模型协议分层

在因特网中，涉及两个或多个远程通信实体的所有活动都受协议的制约。

### 五层模型体系结构：

为了给网络协议的设计提供一个结构，网络设计者以分层的方式组织协议和实现协议的硬件和软件。且每一层具有的协议被称为**协议栈**（protocol stack）。因特网地协议栈由五个层次组成，**自顶向下**(top-down)分别为：

#### 1. 应用层（软件）

- 应用层的分组称为**报文**。

- 应用层协议分布在多个端系统上，端系统之间的应用程序使用协议交换报文。

- 应用层包括许多协议：HTTP（WEB文档的请求和传送），SMTP（电子邮件），FTP（端系统间文件传送）。

#### 2. 传输层（软件）

* 运输层的分组称为**报文段**(segment)。
* 负责向两个主机中进程之间的通信提供服务,应用程序端口之间运输应用层报文。

- 为上一层载荷套接端口信息。
- 两种运输协议：
- **TCP：**
  - 向应用程序提供面向连接的服务，包括应用层报文向目的地的确保传递和流量控制。
  - 通过三次握手，四次挥手建立或断开连接。可靠传输、速度相比UDP慢。
  - 将长报文划分为短报文。
  - 提供拥**塞控制机制**（网络拥塞时，抑制其传输速率）。
- **UDP：**
  - 向应用程序提供无连接式服务，不提供不必要服务。
  - 无可靠性，无流量控制和拥塞控制，速度快。

#### 3. 网络层（硬件软件混合）

+ 网络层的分组称为**数据报**（datagram）。

- 负责给分组提供不同主机之间提供通信服务。

- 协议：IP 网际协议，ICMP 控制报文协议，IGMP 组管理协议，ARP 地址解析协议，RARP反向地址转换协议
- ICMP 控制报文协议：主要用于在主机与路由器之间传递控制信息，包括报告错误、交换受限控制和状态信。
  + ping 用来测试网络可达性。
  + tracert 用来显示到达目的主机的路径
- ARP 地址解析协议：**是网络层的协议，但是它所工作的内容是链路层的。**
- IGMP 组管理协议：是因特网协议家族中的一个组播协议。该协议运行在主机和组播路由器之间。
- RARP反向地址转换协议：允许局域网的物理机器从[网关](https://baike.baidu.com/item/网关/98992)服务器的 ARP 表或者缓存上请求其 IP 地址。
- 为上一层载荷套接IP信息。

#### 4. 链路层（硬件)

- 链路层分组称为**帧**(frame)。
- ARP协议在这里工作，根据上一层header里面的IP解析出MAC地址，并套接。
- 将分组从一个节点（主机或路由器）移动到路径上的下一个节点，网络层必须依靠链路层的服务。
- 两个主机之间的数据传输，总是在一段一段的链路上传送的，也就是说，在两个相邻结点之间传送数据是直接传送的(点对点)，这时就需要使用专门的链路层的协议。
- 链路层包括以太网，WiFi和电缆接入网的DOCSIS协议。

#### 5. 物理层

+ 物理层分组为**比特(bit)**。

- 物理层的任务是将链路层传递的帧中的一个个**比特**从一个节点移动到下一个节点，物理层协议依旧与链路相关，且与链路的实际传输媒体（网线、光纤）有关。

### OSI模型

OSI（Open System Interconnection)参考模型是国际标准化组织（ISO）制定地一个用于计算机或通信系统间互联地标准体系，一般被称为**OSI参考模型**或者**七层模型**。

OSI模型层是自底向上的，即第一层是物理层，第七层是应用层。

OSI模型自上而下分别为应用层、表示层、会话层、运输层、网络层、链路层和物理层。除了表示层和会话层，其他五层与因特网五层模型中地对应层功能相同，所以再补充以下表示层和会话层的功能。

### 表示层

使通信的应用程序能够解释交换数据地含义，包括数据压缩，数据加密和数据描述。

### 会话层

提供数据交换的定界和同步功能，包括建立检查点和恢复方案地方法。

### 报文封装

**封装**(encapsulation)：

- 在发送主机端，一个**应用层报文**(application-layer message)被传送给传输层，传输层收到之后，在报文首部附上首部信息，这个首部信息会被接收端的传输层使用。应用层报文和运输层首部信息一起构成了**运输层报文段**(transport-layer segment)，也就是说运输层封装了应用层报文。

- 同理：运输层则向网络层传递报文段，网络层又类似地在其首部添加注入源和目的端系统地址等网络层首部信息，生成**网络层数据报**(network-layer-datagram)。

- 继续向下，数据包被传递给链路层，链路层继续加上链路层地首部信息，生成**链路层帧**(link-layer-frame)。

**总结**：

- 在每一层地分组都具有两种类型地字段：**首部字段**和**有效载荷字段**(payload field)，所谓<u>有效载荷就是上一层地分组</u>。
- 接收端反向对封装进行重构，一层一层去掉首部信息，以接收原信息。
- 分组：每一层封装并发送/接受包的大小是有限的，所以传输过程中会不断的分组成一个个数据单元来传输。

### 三次握手、四次挥手

**三次握手**

1. 建立连接通常由client发起。
2. 握手过程：
   1. 客户端向服务端发送SYN建链请求报文。
   2. 服务端收到消息后，向客户端发送ASK确认报文，完成客户端到服务端的链接建立。
   3. 服务端继续向客户端发送SYN建链请求报文，请求向客户端发送消息
   4. 客户端收到消息后，向服务暖发送ASK确认报文，完成服务端到客户端的链接建立。
3. 握手过程中2和3都是从服务端到客户端发送消息，故合并到一起。由此产生了三次握手。
4. TCP链接是双向链接，称之为全双工（单工：只能从一端到另一端；半双工：双端通信，但不能同时进行）。

**四次挥手**

1. 断开连接可以由server和client发起。

2. 挥手过程：
    1. A端向B端发送FIN结束报文，等待关闭。
    2. B端收到FIN报文后，向A端发送ASK确认报文。A端到B端的链接关闭。
    3. B端向A端发送FIN结束报文，等待关闭。
    4. A端收到FIN报文后，向B端发送ASK确认报文。B端到A端的链接关闭。
3. 挥手过程中，A端到B端的链接断开后，B端仍然可以继续处理未完成的任务并继续给A端发送消息，并不会同步断开连接。因此断开连接是四次挥手。



## 二、进程间通讯有哪些方式


### 

